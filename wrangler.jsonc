{
  "$schema": "./node_modules/wrangler/config-schema.json",
  // Pipeline Infrastructure (FRED 13). Secrets: DATABASE_URL, OPENROUTER_API_KEY,
  // FIRECRAWL_API_KEY â€” set via `wrangler secret put` or `pnpm run infra:secrets`.
  "name": "agi-canary-pipeline",
  "main": "workers/pipeline/index.ts",
  "compatibility_date": "2025-03-07",
  "compatibility_flags": ["nodejs_compat"],
  "observability": {
    "enabled": true,
    "head_sampling_rate": 1
  },
  "triggers": {
    "crons": ["0 6 * * *"]
  },
  "workers_dev": true,
  "preview_urls": false,
  "vars": {
    "SCORING_VERSION": "1.0.0"
  },
  "r2_buckets": [
    {
      "binding": "DOCUMENTS",
      "bucket_name": "agi-canary-documents-dev"
    }
  ],
  "env": {
    "dev": {
      "name": "agi-canary-pipeline-dev",
      "vars": {
        "SCORING_VERSION": "1.0.0"
      },
      "r2_buckets": [
        {
          "binding": "DOCUMENTS",
          "bucket_name": "agi-canary-documents-dev"
        }
      ]
    },
    "staging": {
      "name": "agi-canary-pipeline-staging",
      "vars": {
        "SCORING_VERSION": "1.0.0"
      },
      "r2_buckets": [
        {
          "binding": "DOCUMENTS",
          "bucket_name": "agi-canary-documents-staging"
        }
      ]
    },
    "prod": {
      "name": "agi-canary-pipeline-prod",
      "vars": {
        "SCORING_VERSION": "1.0.0"
      },
      "r2_buckets": [
        {
          "binding": "DOCUMENTS",
          "bucket_name": "agi-canary-documents-prod"
        }
      ]
    }
  }
}
